<dom-module id="show-plugin">
    
    <template>
        
        <style>
            iframe{
                width:100%;
                height:calc(100vh - 68px);
                border:0;
                padding:0;
                margin:0;
            }
        </style>
        
        <iframe id="currentFrame" security="restricted" sandbox="allow-scripts allow-same-origin" src="{{_frameUrl(route, data, subroute, url, loggedIn)}}"></iframe>
    </template>

    <script>
        class ShowPlugin extends Polymer.Element{
            static get is(){
                return "show-plugin";
            }

            static get properties(){
                return {
                    route: Object,
                    data: Object,
                    subroute: Object,
                    url: Object,
                    currentPluginFrame: {
                        notify: true
                    }
                }
            }
            
            constructor(){
                super();
            }
            
            connectedCallback() {
                super.connectedCallback();
                this.currentPluginFrame = this.shadowRoot.querySelector("#currentFrame");
            }
            
            _frameUrl(route, data, subroute, url, loggedIn){
                if(!loggedIn){
                    return "about:blank";
                }
                //console.log(url);
                return window.location.protocol + "//" + window.location.hostname + ":" + (parseInt(window.location.port)+1) + "/plugins/" + url.page;
            }
            
            toJSON(object){
                return JSON.stringify(object);
            }
            
            ready(){
                super.ready();
                //console.log(this.url);
                //this.firstFrame = this.shadowRoot.querySelector("#currentFrame");
                
            }
        }
        
        customElements.define(ShowPlugin.is, ShowPlugin);
    </script>

</dom-module>